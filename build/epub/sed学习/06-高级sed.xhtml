<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <title>06 高级sed</title>
    <link rel="stylesheet" href="../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> 
  </head>
  <body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="sed">
<h1>06 高级sed</h1>
<div class="section" id="id1">
<h2>6.1 sed是如何工作的</h2>
<p>SED维护两个数据缓冲区：活动模式空间和辅助保持空间。两者最初都是空的。</p>
<p>sed通过对输入的每一行执行以下循环：第一，sed读取输入流中的一行，删除任何换行，和地方它在模式空间。然后执行命令；每个命令都可以有一个与之相关联的地址：地址是一种条件代码，如果在执行命令之前验证条件，则只执行命令。</p>
<p>当脚本结束，除非是在使用-n选项，模式空间的内容打印到输出流，重新加入换行如果它被删除。7再下一个周期开始为下一个输入行。</p>
<p>除非使用特殊命令（如“D”），否则模式空间将在两个周期之间删除。另一方面，保持空间将数据保存在循环之间（见命令“H”、“h”、“x”、“G”、“G”以便在两个缓冲区之间移动数据）。</p>
</div>
<div class="section" id="id2">
<h2>6.2 2个模式的交换</h2>
<dl class="simple">
<dt>d</dt>
<dd><p>从模式空间删除行，直到第一个换行符，并重新启动循环。</p>
</dd>
<dt>G</dt>
<dd><p>将保留空间的行追加到模式空间，并在其之前换行。</p>
</dd>
<dt>H</dt>
<dd><p>将模式空间中的行追加到保存空间中，并在其之前换行。</p>
</dd>
<dt>N</dt>
<dd><p>将输入文件中的行附加到模式空间。</p>
</dd>
<dt>P</dt>
<dd><p>从模式空间打印行，直到第一个换行符。</p>
</dd>
</dl>
<p>样例：</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos74 ~<span class="o">]</span>$ seq <span class="m">6</span> <span class="p">|</span> sed -n <span class="s1">&#39;N;l;D&#39;</span>
<span class="m">1</span><span class="se">\n</span><span class="m">2</span>$
<span class="m">2</span><span class="se">\n</span><span class="m">3</span>$
<span class="m">3</span><span class="se">\n</span><span class="m">4</span>$
<span class="m">4</span><span class="se">\n</span><span class="m">5</span>$
<span class="m">5</span><span class="se">\n</span><span class="m">6</span>$
</pre></div>
</div>
<ol class="arabic simple">
<li><p>开始的时候会读取一行，存在模式空间中，内容是1n</p></li>
<li><p>N;这个命令会从输入文件在读取一行追加到模式空间中去，此时模式空间是1n2n</p></li>
<li><p>l;明确方式打印出模式空间的内容</p></li>
<li><p>D;将模式空间的内容删除到第一个换行符。保留了2。</p></li>
<li><p>继续下面的循环</p></li>
</ol>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>